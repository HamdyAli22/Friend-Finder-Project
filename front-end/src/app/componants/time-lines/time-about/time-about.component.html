<div class="container">
  <div class="timeline">
    <app-time-line-profile></app-time-line-profile>

    <div id="page-contents">
      <div class="row">
        <div class="col-md-3"></div>

        <div class="col-md-7">

          <div class="about-profile" *ngIf="!loading">

            <!-- Personal Information -->
            <div class="about-content-block">
              <div class="d-flex align-items-center w-100">
                <h4 class="grey mb-0">
                  <i class="ion-ios-information-outline icon-in-title"></i>
                  Personal Information
                </h4>

                <div class="ml-auto d-flex align-items-center gap-1">
                  <button
                    class="btn btn-sm btn-outline-primary"
                    (click)="openPersonalInfoModal()"
                    [title]="aboutProfile.personalInfo ? 'Edit' : 'Add'">
                    <i class="ion"
                       [ngClass]="aboutProfile.personalInfo ? 'ion-edit' : 'ion-plus'"></i>
                  </button>

                  <button
                    *ngIf="aboutProfile.personalInfo"
                    class="btn btn-sm btn-outline-danger"
                    title="Delete"
                    (click)="openDeleteDialog('personalInfo')">
                    <i class="ion ion-trash-a"></i>
                  </button>
                </div>
              </div>

              <p class="mt-2">
                {{ aboutProfile?.personalInfo || 'No personal information added yet.' }}
              </p>
            </div>

            <!-- Location -->
            <div class="about-content-block">
              <div class="d-flex align-items-center w-100">
                <h4 class="grey mb-0">
                  <i class="ion-ios-location-outline icon-in-title"></i>
                  Location
                </h4>

                <div class="ml-auto d-flex gap-1">
                  <button
                    class="btn btn-sm btn-outline-primary"
                    (click)="openLocationModal()"
                    [title]="aboutProfile.address ? 'Edit' : 'Add'">
                    <i class="ion" [ngClass]="aboutProfile.address ? 'ion-edit' : 'ion-plus'"></i>
                  </button>

                  <button
                    *ngIf="aboutProfile.address"
                    class="btn btn-sm btn-outline-danger"
                    title="Delete"
                    (click)="openDeleteDialog('location')">
                    <i class="ion ion-trash-a"></i>
                  </button>
                </div>
              </div>

              <p class="mt-2">
                {{ aboutProfile?.address || 'No location added yet.' }}
              </p>
            </div>

            <!-- Work Experiences -->
            <div class="about-content-block work-experiences">
              <div class="d-flex align-items-center w-100">
                <h4 class="grey mb-0">
                  <i class="ion-ios-briefcase-outline icon-in-title"></i>
                  Work Experiences
                </h4>

                <div class="ml-auto d-flex gap-1">
                  <!-- Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø®Ø¨Ø±Ø© -->
                  <button class="btn btn-sm btn-outline-primary" (click)="openWorkModal()">
                    <i class="ion ion-plus"></i>
                  </button>

                  <!-- Ø²Ø± Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø®Ø¨Ø±Ø§Øª -->
                  <button
                    class="btn btn-sm btn-outline-danger"
                    *ngIf="aboutProfile?.workExperiences?.length"
                    title="Delete All"
                    (click)="openDeleteDialog('work')">
                    <i class="ion ion-trash-a"></i>
                  </button>
                </div>
              </div>

              <div class="organization" *ngFor="let work of aboutProfile?.workExperiences || []">
                <img src="assets/images/envato.png" class="pull-left img-org">

                <div class="work-info">
                  <div class="d-flex align-items-start">
                    <div class="work-text">
                      <h5 class="company-name">{{ work.companyName }}</h5>
                      <p class="job-line">
                        {{ work.jobTitle }} -
                        <span class="text-grey">
                          {{ work.startDate | date:'d MMMM y' }}
                          to
                          {{ work.currentJob ? 'Present' : (work.endDate | date:'d MMMM y') }}
                        </span>
                      </p>
                    </div>

                    <div class="ml-auto d-flex gap-1">
                      <button
                        class="btn btn-sm btn-link"
                        (click)="openWorkModal(work)">
                        <i class="ion ion-edit"></i>
                      </button>

                      <button
                        class="btn btn-sm btn-link text-danger"
                        (click)="openDeleteDialog('work', work)">
                        <i class="ion ion-trash-a"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <p *ngIf="!(aboutProfile?.workExperiences?.length)">
                No work experiences added yet.
              </p>
            </div>


            <!-- Interests -->
            <div class="about-content-block interests-block">
              <div class="d-flex align-items-center w-100">
                <h4 class="grey mb-0">
                  <i class="ion-ios-heart-outline icon-in-title"></i>
                  Interests
                </h4>

                <div class="ml-auto d-flex gap-1">
                   <button
                     class="btn btn-sm btn-outline-primary"
                     (click)="openInterestModal()">
                      <i class="ion ion-plus"></i>
                   </button>

                   <button
                      class="btn btn-sm btn-outline-danger"
                      *ngIf="aboutProfile?.interests?.length"
                       title="Delete All"
                       (click)="openDeleteDialog('interest')">
                       <i class="ion ion-trash-a"></i>
                   </button>
                </div>
              </div>

              <ul class="interests-list">
                <li *ngFor="let interest of aboutProfile?.interests || []"
                    class="row-with-actions">
                  <span class="row-content interest-name">
                    {{ interest.name }}
                  </span>

                  <div class="row-actions">
                    <button
                      class="btn btn-sm btn-link"
                      (click)="openInterestModal(interest)">
                      <i class="ion ion-edit"></i>
                    </button>

                    <button
                      class="btn btn-sm btn-link text-danger"
                      (click)="openDeleteDialog('interest', interest)">
                      <i class="ion ion-trash-a"></i>
                    </button>
                  </div>
                </li>
              </ul>

              <p *ngIf="!(aboutProfile?.interests?.length)">
                No interests added yet.
              </p>
            </div>

            <!-- Languages -->
            <div class="about-content-block languages-block">
              <div class="d-flex align-items-center w-100">
                <h4 class="grey mb-0">
                  <i class="ion-ios-chatbubble-outline icon-in-title"></i>
                  Languages
                </h4>

                <div class="ml-auto d-flex gap-1">
                     <button
                     class="btn btn-sm btn-outline-primary"
                     (click)="openLanguageModal()">
                     <i class="ion ion-plus"></i>
                     </button>

                     <button
                       class="btn btn-sm btn-outline-danger"
                       *ngIf="aboutProfile?.languages?.length"
                       title="Delete All"
                       (click)="openDeleteDialog('language')">
                       <i class="ion ion-trash-a"></i>
                     </button>
                </div>
              </div>

              <ul class="languages-list">
                <li *ngFor="let lang of aboutProfile?.languages || []"
                    class="row-with-actions">
                  <span class="row-content language-name">
                    {{ lang.name }}
                  </span>

                  <div class="row-actions">
                    <button
                      class="btn btn-sm btn-link"
                      (click)="openLanguageModal(lang)">
                      <i class="ion ion-edit"></i>
                    </button>

                    <button
                      class="btn btn-sm btn-link text-danger"
                      (click)="openDeleteDialog('language', lang)">
                      <i class="ion ion-trash-a"></i>
                    </button>
                  </div>
                </li>
              </ul>

              <p *ngIf="!(aboutProfile?.languages?.length)">
                No languages added yet.
              </p>
            </div>

            <!-- ðŸ”´ Global Delete Dialog -->
            <div class="modal-backdrop" *ngIf="deleteDialogOpen">
              <div class="modal-content">
                <h5>
                  Delete
                  <span *ngIf="deleteTargetType === 'personalInfo'">Personal Information</span>
                  <span *ngIf="deleteTargetType === 'location'">Location</span>
                  <span *ngIf="deleteTargetType === 'work'">Work Experience</span>
                  <span *ngIf="deleteTargetType === 'interest'">Interest</span>
                  <span *ngIf="deleteTargetType === 'language'">Language</span>
                  ?
                </h5>

                <p class="text-muted">
                  Are you sure you want to delete this item? This action cannot be undone.
                </p>

                <div class="modal-actions mt-3">
                  <button class="btn btn-danger btn-sm" (click)="confirmDelete()">Delete</button>
                  <button class="btn btn-secondary btn-sm" (click)="deleteDialogOpen = false">
                    Cancel
                  </button>
                </div>
              </div>
            </div>

            <!-- ðŸ”´ ÙƒÙ„ Ø§Ù„Ù€ Modals Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø²ÙŠ Ù…Ø§ Ù‡ÙŠ (Personal, Location, Work, Interest, Language) -->
            <!-- Modal Personal Info -->
            <div class="modal-backdrop" *ngIf="personalInfoModalOpen">
              <div class="modal-content">
                <h5>{{ aboutProfile.personalInfo ? 'Edit' : 'Add' }} Personal Information</h5>
                <textarea [(ngModel)]="personalInfoTemp" rows="5" class="form-control"></textarea>
                <div class="modal-actions mt-2">
                  <button class="btn btn-primary btn-sm" (click)="savePersonalInfo()">Save</button>
                  <button class="btn btn-secondary btn-sm" (click)="closePersonalInfoModal()">Cancel</button>
                </div>
              </div>
            </div>

            <!-- Modal Location -->
            <div class="modal-backdrop" *ngIf="locationModalOpen">
              <div class="modal-content">
                <h5>{{ aboutProfile.address ? 'Edit' : 'Add' }} Location</h5>
                <input type="text" [(ngModel)]="locationTemp" class="form-control" placeholder="Enter your location" />
                <div class="modal-actions mt-2">
                  <button class="btn btn-primary btn-sm" (click)="saveLocation()">Save</button>
                  <button class="btn btn-secondary btn-sm" (click)="closeLocationModal()">Cancel</button>
                </div>
              </div>
            </div>

            <!-- Modal Work Experience -->
            <div class="modal-backdrop" *ngIf="workModalOpen">
              <div class="modal-content">
                <h5>{{ editingWork ? 'Edit' : 'Add' }} Work Experience</h5>
                <input type="text" class="form-control mb-2" placeholder="Company Name" [(ngModel)]="workTemp.companyName">
                <input type="text" class="form-control mb-2" placeholder="Job Title" [(ngModel)]="workTemp.jobTitle">
                <input type="date" class="form-control mb-2" [(ngModel)]="workTemp.startDate">
                <input type="date" class="form-control mb-2" *ngIf="!workTemp.currentJob" [(ngModel)]="workTemp.endDate">
                <label class="d-flex align-items-center">
                  <input type="checkbox" [(ngModel)]="workTemp.currentJob">
                  <span class="ml-2">Current Job</span>
                </label>
                <div class="modal-actions mt-3">
                  <button class="btn btn-primary btn-sm" (click)="saveWork()">Save</button>
                  <button class="btn btn-secondary btn-sm" (click)="closeWorkModal()">Cancel</button>
                </div>
              </div>
            </div>

            <!-- Modal Interest -->
            <div class="modal-backdrop" *ngIf="interestModalOpen">
              <div class="modal-content">
                <h5>{{ editingInterest ? 'Edit' : 'Add' }} Interest</h5>
                <input type="text" class="form-control" placeholder="Interest name" [(ngModel)]="interestTemp.name">
                <div class="modal-actions mt-3">
                  <button class="btn btn-primary btn-sm" (click)="saveInterest()">Save</button>
                  <button class="btn btn-secondary btn-sm" (click)="closeInterestModal()">Cancel</button>
                </div>
              </div>
            </div>

            <!-- Modal Language -->
            <div class="modal-backdrop" *ngIf="languageModalOpen">
              <div class="modal-content">
                <h5>{{ editingLanguage ? 'Edit' : 'Add' }} Language</h5>
                <input type="text" class="form-control" placeholder="Language name" [(ngModel)]="languageTemp.name">
                <div class="modal-actions mt-3">
                  <button class="btn btn-primary btn-sm" (click)="saveLanguage()">Save</button>
                  <button class="btn btn-secondary btn-sm" (click)="closeLanguageModal()">Cancel</button>
                </div>
              </div>
            </div>


          </div>
        </div>


      </div>
    </div>
  </div>
</div>
